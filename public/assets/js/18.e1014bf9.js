(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{534:function(t,e,r){t.exports=r.p+"assets/img/xhr-mock.9d7be32d.png"},558:function(t,e,r){"use strict";r.r(e);var s=r(4),a=Object(s.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"xhr-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#xhr-mock"}},[t._v("#")]),t._v(" xhr-mock")]),t._v(" "),s("p",[t._v("ä½œä¸ºmock è¯·æ±‚éå¸¸æœ‰æ•ˆ")]),t._v(" "),s("p",[t._v("å¯¹äºæµ‹è¯•å’ŒåŸå‹è®¾è®¡ååˆ†æœ‰æ•ˆï¼Œç‰¹åˆ«æ˜¯åå°è¿˜åœ¨ç¼–å†™çš„æ—¶å€™")]),t._v(" "),s("p",[t._v("å¯ä»¥åœ¨node ç¯å¢ƒå’Œæµè§ˆå™¨ç¯å¢ƒè¿è¡Œ. èƒ½å¤Ÿå…¼å®¹Â "),s("strong",[s("a",{attrs:{href:"https://www.npmjs.com/package/axios",target:"_blank",rel:"noopener noreferrer"}},[t._v("Axios"),s("OutboundLink")],1)]),t._v(",Â "),s("strong",[s("a",{attrs:{href:"https://www.npmjs.com/package/jquery",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuery"),s("OutboundLink")],1)]),t._v(",Â "),s("strong",[s("a",{attrs:{href:"https://www.npmjs.com/package/superagent",target:"_blank",rel:"noopener noreferrer"}},[t._v("Superagent"),s("OutboundLink")],1),t._v("ç”šè‡³å…¶ä»–çš„åº“åªè¦æ˜¯æŒ‰ç…§")]),s("code",[t._v("XMLHttpRequest")]),t._v("æ ‡å‡† æ„å»ºçš„ï¼Œéƒ½æ²¡æœ‰é—®é¢˜.")]),t._v(" "),s("p",[t._v("å®‰è£…æ–¹æ³•")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("yarn add --dev xhr-mock\n")])])]),s("p",[t._v("ä½¿ç”¨çš„è¯webpackå¯ä»¥ç›´æ¥import æµè§ˆå™¨ç¯å¢ƒ")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("import mock from 'xhr-mock';\n<script src=\"https://unpkg.com/xhr-mock/dist/xhr-mock.js\"><\/script>\n")])])]),s("p",[t._v("ä½¿ç”¨åˆ—å­ï¼š")]),t._v(" "),s("p",[t._v("æˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„httpè¯·æ±‚å¤„ç†ä½¿ç”¨çš„axios ä¹Ÿå¯ä»¥æ»¡è¶³ä½¿ç”¨socketç­‰")]),t._v(" "),s("p",[t._v("ä¸‹é¢å°±æ˜¯ä¸€ä¸ªç®€å•çš„åˆ—å­")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("// mockæ–‡ä»¶\nimport mock from 'xhr-mock';\n\nconst mockTempleList = [{\ndata:{\n\t\trows: [\n\t\t    {\n\t\t      expand: false,\n\t\t      functionCode: 'HR',\n\t\t      icon: 'fa fa-cubes',\n\t\t      id: 2,\n\t\t      ischecked: null,\n\t\t      score: 10,\n\t\t      shortcutId: null,\n\t\t      text: 'ç»„ç»‡æ¶æ„',\n\t\t      url: null,\n\t\t      symbol: '0',\n\t\t      parentId: 125,\n\t\t    },\n\t\t  ],\n\t\t  success: true,\n\t\t  total: 10,\n\t\t},\nrule:/\\/tree.mock/\n}]\n\nexport function setup() {\n  mock.setup();\n  if (mockTempleList.length >= 1) {\n    mockTempleList.map((item) => {\n      const { rule, data } = item;\n      mock.post(rule, {\n        status: 201,\n        body: JSON.stringify(data),\n      });\n    });\n  }\n}\n\nexport const teardown = mock.teardown.bind(mock);\n")])])]),s("p",[t._v("ç„¶åå»ºç«‹ä¸€ä¸ªæµ‹è¯•æ–‡ä»¶")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("import { setup, teardown } from './mock';\n\ndescribe('axios test ', () => {\n  beforeEach(() => {\n    setup();\n    jest.useFakeTimers();\n  });\n\n  afterEach(() => {\n    teardown();\n    jest.useRealTimers();\n  });\n\n  it('should input value is equal to one', () => {\n    const { wrapper } = setupByMount();\n    axios\n      .post('/tree.mock', {})\n      .then(res => {\n        console.log(res);\n      })\n      .catch(err => {\n        console.log(err);\n      });\n    jest.advanceTimersByTime(4000);\n    wrapper.update();\n    wrapper.find('.c7n-tree-node-content-wrapper').simulate('click');\n    expect(wrapper.find('NumberField').prop('value')).toBe(1);\n    expect(wrapper).toMatchSnapshot();\n  });\n});\n")])])]),s("p",[t._v("ç„¶åè¿è¡Œæµ‹è¯•è¿™é‡Œå¯ä»¥çœ‹å‡ºæ˜¯å¯ä»¥è¢«æ‹¦æˆªçš„")]),t._v(" "),s("p",[s("img",{attrs:{src:r(534),alt:"xhr-mock.png"}})]),t._v(" "),s("h3",{attrs:{id:"apiè¯¦è§£"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#apiè¯¦è§£"}},[t._v("#")]),t._v(" apiè¯¦è§£")]),t._v(" "),s("h3",{attrs:{id:"setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".setup()")])]),t._v(" "),s("p",[t._v("æ›¿æ¢å…¨å±€çš„Â "),s("code",[t._v("XMLHttpRequest")]),t._v("Â çš„å¯¹è±¡å˜æˆÂ "),s("code",[t._v("MockXMLHttpRequest")]),t._v(".")]),t._v(" "),s("h3",{attrs:{id:"teardown"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#teardown"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".teardown()")])]),t._v(" "),s("p",[t._v("é‡æ–°æ¢å¤Â "),s("code",[t._v("XMLHttpRequest")]),t._v("Â å¯¹è±¡åˆ°åˆå§‹çš„çŠ¶æ€.")]),t._v(" "),s("h3",{attrs:{id:"reset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reset"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".reset()")])]),t._v(" "),s("p",[t._v("ç§»é™¤æ‰€æœ‰çš„è¯·æ±‚ç¨‹åº")]),t._v(" "),s("h3",{attrs:{id:"get-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#get-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".get(url | regex, mock)")])]),t._v(" "),s("p",[t._v("åˆ›å»ºä¸€ä¸ªgetè¯·æ±‚è¦æ±‚ä¸€ä¸ªurlçš„æ­£åˆ™è¡¨è¾¾å¼ä¸€ä¸ªmockæ•°æ®")]),t._v(" "),s("p",[t._v("mock.get(/."),s("em",[s("strong",[s("strong",[t._v(".json")]),t._v("$")]),t._v("/,Â {Â body")]),t._v('*ğŸ˜—*Â JSON.stringify({Â data**ğŸ˜—*Â {Â id**ğŸ˜—*Â "abc"Â }Â })});')]),t._v(" "),s("h3",{attrs:{id:"post-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#post-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".post(url | regex, mock)")])]),t._v(" "),s("p",[t._v("å»ºç«‹ä¸€ä¸ªpostè¯·æ±‚")]),t._v(" "),s("h3",{attrs:{id:"put-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#put-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".put(url | regex, mock)")])]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªputè¯·æ±‚")]),t._v(" "),s("h3",{attrs:{id:"patch-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#patch-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".patch(url | regex, mock)")])]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªpatch è¯·æ±‚")]),t._v(" "),s("h3",{attrs:{id:"delete-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".delete(url | regex, mock)")])]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªdelete çš„è¯·æ±‚")]),t._v(" "),s("h3",{attrs:{id:"use-method-url-regex-mock"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-method-url-regex-mock"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".use(method, url | regex, mock)")])]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªè¯·æ±‚æ‹¦æˆªæ‰€æœ‰å¯¹ç›¸åº”çš„url")]),t._v(" "),s("h3",{attrs:{id:"use-fn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#use-fn"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".use(fn)")])]),t._v(" "),s("p",[t._v("æ³¨å†Œä¸€ä¸ªæ–¹æ³•ç»™æ‰€æœ‰çš„è¯·æ±‚å“åº”")]),t._v(" "),s("h3",{attrs:{id:"error-fn"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#error-fn"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".error(fn)")])]),t._v(" "),s("p",[t._v("æŠ›å‡ºå¼‚å¸¸çš„é’©å­å“åº”")]),t._v(" "),s("h2",{attrs:{id:"mockxmlhttprequest"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mockxmlhttprequest"}},[t._v("#")]),t._v(" "),s("strong",[t._v("MockXMLHttpRequest")])]),t._v(" "),s("h3",{attrs:{id:"method-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#method-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".method() : string")])]),t._v(" "),s("p",[t._v("è·å–è¯·æ±‚ä¿¡æ¯çš„æ–¹æ³•")]),t._v(" "),s("h3",{attrs:{id:"url-mockurl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#url-mockurl"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".url() : MockURL")])]),t._v(" "),s("p",[t._v("è·å–è¯·æ±‚url")]),t._v(" "),s("h3",{attrs:{id:"header-name-string-value-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#header-name-string-value-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".header(name : string, value: string)")])]),t._v(" "),s("p",[t._v("è®¾ç½®è¯·æ±‚å¤´")]),t._v(" "),s("h3",{attrs:{id:"header-name-string-string-null"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#header-name-string-string-null"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".header(name : string) : string | null")])]),t._v(" "),s("p",[t._v("è·å–è¯·æ±‚å¤´")]),t._v(" "),s("h3",{attrs:{id:"headers-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-object"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".headers() : object")])]),t._v(" "),s("p",[t._v("è·å–æ‰€æœ‰çš„å¤´éƒ¨ä¿¡æ¯")]),t._v(" "),s("h3",{attrs:{id:"headers-headers-object"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-headers-object"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".headers(headers : object)")])]),t._v(" "),s("p",[t._v("è®¾ç½®è¯·æ±‚çš„å¤´éƒ¨ä¿¡æ¯")]),t._v(" "),s("h3",{attrs:{id:"body-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#body-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".body() : string")])]),t._v(" "),s("p",[t._v("è·å–è¯·æ±‚çš„body")]),t._v(" "),s("h3",{attrs:{id:"body-body-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#body-body-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".body(body : string)")])]),t._v(" "),s("p",[t._v("ç¤¾ä¼šå­è¯·æ±‚çš„body")]),t._v(" "),s("h3",{attrs:{id:"mockresponse"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mockresponse"}},[t._v("#")]),t._v(" "),s("strong",[t._v("MockResponse")])]),t._v(" "),s("h3",{attrs:{id:"status-number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#status-number"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".status() : number")])]),t._v(" "),s("p",[t._v("è·å–è¯·æ±‚çŠ¶æ€")]),t._v(" "),s("h3",{attrs:{id:"status-code-number"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#status-code-number"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".status(code : number)")])]),t._v(" "),s("p",[t._v("è®¾ç½®è¯·æ±‚çŠ¶æ€")]),t._v(" "),s("h3",{attrs:{id:"reason-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reason-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".reason() : string")])]),t._v(" "),s("p",[t._v("è·å–å“åº”åŸå› ")]),t._v(" "),s("h3",{attrs:{id:"reason-phrase-string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#reason-phrase-string"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".reason(phrase : string)")])]),t._v(" "),s("p",[t._v("è®¾ç½®å“åº”åŸå› ")]),t._v(" "),s("h3",{attrs:{id:"header-name-string-value-string-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#header-name-string-value-string-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".header(name : string, value: string)")])]),t._v(" "),s("p",[t._v("è®¾ç½®å“åº”å¤´éƒ¨")]),t._v(" "),s("h3",{attrs:{id:"header-name-string-string-null-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#header-name-string-string-null-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".header(name : string) : string | null")])]),t._v(" "),s("p",[t._v("è·å–ä¸€ä¸ªå“åº”å¤´éƒ¨")]),t._v(" "),s("h3",{attrs:{id:"headers-object-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-object-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".headers() : object")])]),t._v(" "),s("p",[t._v("è·å–æ‰€æœ‰çš„å“åº”å¤´éƒ¨")]),t._v(" "),s("h3",{attrs:{id:"headers-headers-object-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#headers-headers-object-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".headers(headers : object)")])]),t._v(" "),s("p",[t._v("è®¾ç½®æ‰€æœ‰å“åº”å¤´éƒ¨")]),t._v(" "),s("h3",{attrs:{id:"body-string-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#body-string-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".body() : string")])]),t._v(" "),s("p",[t._v("è·å–å“åº”body")]),t._v(" "),s("h3",{attrs:{id:"body-body-string-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#body-body-string-2"}},[t._v("#")]),t._v(" "),s("strong",[t._v(".body(body : string)")])]),t._v(" "),s("p",[t._v("è®¾ç½®å“åº”body")]),t._v(" "),s("p",[t._v("ä¸‹é¢åˆ—å‡ºä¸€äº›ç‰¹æ®Šçš„ä½¿ç”¨")]),t._v(" "),s("p",[t._v("Upload progress")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("import mock from 'xhr-mock';\n \nmock.setup();\n \nmock.post('/', {});\n \nconst xhr = new XMLHttpRequest();\nxhr.upload.onprogress = event => console.log(event.loaded, event.total);\nxhr.open('POST', '/');\nxhr.setRequestHeader('Content-Length', '12');\nxhr.send('Hello World!');\n")])])]),s("p",[t._v("Download progress")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[t._v("import mock from 'xhr-mock';\n \nmock.setup();\n \nmock.get('/', {\n  headers: {'Content-Length': '12'},\n  body: 'Hello World!'\n});\n \nconst xhr = new XMLHttpRequest();\nxhr.onprogress = event => console.log(event.loaded, event.total);\nxhr.open('GET', '/');\nxhr.send();\n")])])]),s("h3",{attrs:{id:"é¡¹ç›®å¤„ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é¡¹ç›®å¤„ç†"}},[t._v("#")]),t._v(" é¡¹ç›®å¤„ç†")]),t._v(" "),s("p",[t._v("ç”±äºæ— æ³•åœ¨é¡¹ç›®ä¸­ä½¿ç”¨mockjs è¿›è¡Œæ‹¦æˆªæµ‹è¯•æ‰€ä»¥é‡‡ç”¨è¿™ä¸ªæ¡†æ¶æ‹¦æˆªè¯·æ±‚ç„¶åä½¿ç”¨mockjsç”Ÿæˆmockæ•°æ®ã€‚è¿™æ ·ä¸ä½†ä¸ä¼šå½±å“æ•´ä¸ªé¡¹ç›®çš„åŸæ–¹å¼mockä¹Ÿå¯ä»¥æ»¡è¶³ç­–æµ‹è¯•éœ€è¦")])])}),[],!1,null,null,null);e.default=a.exports}}]);